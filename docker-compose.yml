version: '3.7'
services:
  db:
    container_name: dnf_db
    image: mysql:5.7
    restart: always
    hostname: db
    ports:
    - 3308:3306
    networks:
    - cloud_net
    volumes:
    - ./mysql/data:/var/lib/mysql
    - ./conf.d:/etc/mysql/conf.d
    environment:
    - MYSQL_ROOT_PASSWORD=root

  dnf:
    image: scjtqs/dnf-centos5
    container_name: dnf
    hostname: dnf
    privileged: true
    tty: true
    depends_on:
    - db
    environment:
    - DB_HOST=db
    - PublicIp=192.168.50.184
    ports:
    - 2311-2313:2311-2313/tcp
    - 2311-2313:2311-2313/udp
    - 7000-7001:7000-7001/udp
    - 7000-7001:7000-7001/tcp
    - 7200-7201:7200-7201/tcp
    - 7200-7201:7200-7201/udp
    - 8000:8000/tcp
    - 8000:8000/udp
    - 8100:8100/tcp
    - 8100:8100/udp
    - 9006:9006/tcp
    - 9006:9006/udp
    - 10001:10001/tcp
    - 11001:11001/udp
    - 10031:10031/tcp
    - 11031:11031/udp
    - 20017-20018:20017-20018/tcp
    - 20017-20018:20017-20018/udp
    - 20201:20201/tcp
    - 20201:20201/udp
    - 20203:20203/tcp
    - 20203:20203/udp
    - 20301:20301/tcp
    - 20301:20301/udp
    - 20303:20303/tcp
    - 20303:20303/udp
    - 20401:20401/tcp
    - 20401:20401/udp
    - 20403:20403/tcp
    - 20403:20403/udp
    - 30301:30301/tcp
    - 30301:30301/udp
    - 30303:30303/tcp
    - 30303:30303/udp
    - 30401:30401/tcp
    - 30401:30401/udp
    - 30403:30403/tcp
    - 30403:30403/udp
    - 30501:30501/tcp
    - 30501:30501/udp
    - 30503:30503/tcp
    - 30503:30503/udp
    - 30601:30601/tcp
    - 30601:30601/udp
    - 30701:30701/tcp
    - 30701:30701/udp
    - 30801:30801/tcp
    - 30801:30801/udp
    - 31001:31001/tcp
    - 31001:31001/udp
    - 31100:31100/tcp
    - 31100:31100/udp

    networks:
    - cloud_net
    volumes:
    - ./home:/home
    - ./root:/root

networks:
  cloud_net:
